{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Outlet,Link,useLocation,redirect}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Layout=function Layout(_ref){var profileRoute=_ref.profileRoute,setProfileRoute=_ref.setProfileRoute;var location=useLocation();// const request = new XMLHttpRequest();\nuseEffect(function(){// try {\n// request.open('GET', 'https://music-pwa-api.iran.liara.run/api/users/auth');\n// request.responseType = 'json';\n// request.addEventListener('load', () => {\n//     const res=request.response;\n//     if(res?.isLogin){\n//         if(request.response.role=='admin'){\n//             setProfileRoute('adminprofile');\n//         } else if(res?.role=='user'){\n//             setProfileRoute('userprofile');\n//         }\n//     }\n// });\n// request.addEventListener('error', () => console.error('XHR error'));\n// request.send();\n// } catch (error) {\n// console.error(`XHR error ${request.status}`);\n// }\nvar jwtToken=document.cookie.split('=')[1];console.log(jwtToken);var option={method:'POST',body:JSON.stringify({jwtToken:jwtToken}),headers:{'Content-type':'application/json; charset=UTF-8'}};fetch('https://music-pwa-api.iran.liara.run/api/users/auth',option).then(function(res){return res.json();}).then(function(data){if(jwtToken){if(data!==null&&data!==void 0&&data.isLogin){if((data===null||data===void 0?void 0:data.role)=='admin'){setProfileRoute('adminprofile');}else if((data===null||data===void 0?void 0:data.role)=='user'){setProfileRoute('userprofile');}}}});},[location]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"header\",{className:\"header\",id:\"header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"nav-container-top\",children:[/*#__PURE__*/_jsx(\"a\",{href:\"#\",className:\"nav__logo\",children:\"Marlon\"}),/*#__PURE__*/_jsx(\"img\",{src:\"/img/Mehrdad - Masale.jpg\",alt:\"\",className:\"nav__img\"})]}),/*#__PURE__*/_jsx(\"nav\",{className:\"nav-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"nav__menu\",id:\"nav-menu\",children:/*#__PURE__*/_jsxs(\"ul\",{className:\"nav__list\",children:[/*#__PURE__*/_jsx(Link,{to:\"/\",children:/*#__PURE__*/_jsx(\"li\",{className:\"nav__item\",id:\"home-btn\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"nav__link\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bx bx-home-alt nav__icon\"}),/*#__PURE__*/_jsx(\"span\",{className:\"nav__name\",children:\"\\u062E\\u0627\\u0646\\u0647\"})]})})}),/*#__PURE__*/_jsx(Link,{to:\"/search\",children:/*#__PURE__*/_jsx(\"li\",{className:\"nav__item\",id:\"search-btn\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"nav__link\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bx bx-search-alt nav__icon\"}),/*#__PURE__*/_jsx(\"span\",{className:\"nav__name\",children:\"\\u062C\\u0633\\u062A\\u062C\\u0648\"})]})})}),/*#__PURE__*/_jsx(Link,{to:\"/playlist\",children:/*#__PURE__*/_jsx(\"li\",{className:\"nav__item\",id:\"playlist-btn\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"nav__link\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bx bx-book-alt nav__icon\"}),/*#__PURE__*/_jsx(\"span\",{className:\"nav__name\",children:\"\\u067E\\u0644\\u06CC \\u0644\\u06CC\\u0633\\u062A\"})]})})}),/*#__PURE__*/_jsx(Link,{to:profileRoute,children:/*#__PURE__*/_jsx(\"li\",{className:\"nav__item\",id:\"profile-btn\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"nav__link\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bx bx-user nav__icon\"}),/*#__PURE__*/_jsx(\"span\",{className:\"nav__name\",children:\"\\u062D\\u0633\\u0627\\u0628 \\u06A9\\u0627\\u0631\\u0628\\u0631\\u06CC\"})]})})})]})})})]}),/*#__PURE__*/_jsx(Outlet,{})]});};export default Layout;","map":{"version":3,"names":["React","useState","useEffect","Outlet","Link","useLocation","redirect","Layout","profileRoute","setProfileRoute","location","jwtToken","document","cookie","split","console","log","option","method","body","JSON","stringify","headers","fetch","then","res","json","data","isLogin","role"],"sources":["D:/github/music-pwa-frontend/src/pages/Layout.jsx"],"sourcesContent":["import React, { useState,useEffect } from 'react'\r\nimport { Outlet, Link, useLocation, redirect } from \"react-router-dom\";\r\n\r\n\r\nconst Layout = ({profileRoute,setProfileRoute}) => {\r\n\r\n    \r\n    const location=useLocation();  \r\n    // const request = new XMLHttpRequest();\r\n  \r\n    useEffect(()=>{\r\n        // try {\r\n        // request.open('GET', 'https://music-pwa-api.iran.liara.run/api/users/auth');\r\n\r\n        // request.responseType = 'json';\r\n\r\n        // request.addEventListener('load', () => {\r\n        //     const res=request.response;\r\n        //     if(res?.isLogin){\r\n        //         if(request.response.role=='admin'){\r\n        //             setProfileRoute('adminprofile');\r\n        //         } else if(res?.role=='user'){\r\n        //             setProfileRoute('userprofile');\r\n        //         }\r\n        //     }\r\n        // });\r\n        // request.addEventListener('error', () => console.error('XHR error'));\r\n\r\n        // request.send();\r\n        \r\n        // } catch (error) {\r\n        // console.error(`XHR error ${request.status}`);\r\n        // }\r\n        const jwtToken=document.cookie.split('=')[1];  \r\n        console.log(jwtToken)   \r\n        const option = {\r\n            method: 'POST',\r\n            body: JSON.stringify({\r\n                jwtToken\r\n            }),\r\n            headers: {\r\n            'Content-type': 'application/json; charset=UTF-8',\r\n            }\r\n        };\r\n    \r\n        fetch('https://music-pwa-api.iran.liara.run/api/users/auth',option)\r\n        .then((res)=> res.json())\r\n        .then((data)=>{\r\n                if(jwtToken){\r\n                    if(data?.isLogin){\r\n                        if(data?.role=='admin'){\r\n                            setProfileRoute('adminprofile');\r\n                        } else if(data?.role=='user'){\r\n                            setProfileRoute('userprofile');\r\n                        }\r\n                    }\r\n                }\r\n        })\r\n        \r\n    },[location])\r\n\r\n\r\n\r\n  return (\r\n    <div>\r\n    <header className='header' id='header'>\r\n                <div className='nav-container-top'>\r\n                  <a href=\"#\" className=\"nav__logo\">Marlon</a>        \r\n                  <img src=\"/img/Mehrdad - Masale.jpg\" alt=\"\" className=\"nav__img\"/>\r\n                </div>\r\n        <nav className='nav-container'>                          \r\n                <div className='nav__menu' id=\"nav-menu\">\r\n                    <ul className=\"nav__list\">\r\n                    <Link to=\"/\">\r\n                        <li className=\"nav__item\"  id=\"home-btn\" >\r\n                            <div className=\"nav__link\">\r\n                                <i className='bx bx-home-alt nav__icon'></i>\r\n                                <span className=\"nav__name\">خانه</span>\r\n                            </div>\r\n                        </li>\r\n                    </Link>\r\n                    <Link to=\"/search\">\r\n                        <li className=\"nav__item\" id=\"search-btn\">\r\n                            <div className=\"nav__link\">\r\n                                <i className='bx bx-search-alt nav__icon'></i>\r\n                                <span className=\"nav__name\">جستجو</span>\r\n                            </div>\r\n                        </li>\r\n                    </Link>\r\n                    <Link to=\"/playlist\">\r\n                        <li className=\"nav__item\" id=\"playlist-btn\">\r\n                            <div className=\"nav__link\">\r\n                                <i className='bx bx-book-alt nav__icon'></i>\r\n                                <span className=\"nav__name\">پلی لیست</span>\r\n                            </div>\r\n                        </li>\r\n                    </Link>\r\n                    <Link to={profileRoute} > \r\n                        <li className=\"nav__item\" id=\"profile-btn\">\r\n                            <div className=\"nav__link\">\r\n                                <i className='bx bx-user nav__icon'></i>\r\n                                <span className=\"nav__name\">حساب کاربری</span>\r\n                            </div>\r\n                        </li>\r\n                    </Link>\r\n                    </ul>\r\n                </div>\r\n            </nav>\r\n    </header>\r\n      <Outlet />\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Layout"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}