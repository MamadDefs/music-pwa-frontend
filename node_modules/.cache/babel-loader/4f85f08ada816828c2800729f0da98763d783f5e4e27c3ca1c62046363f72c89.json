{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Outlet,Link,useLocation,redirect}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Layout=function Layout(_ref){var profileRoute=_ref.profileRoute,setProfileRoute=_ref.setProfileRoute,userInfo=_ref.userInfo,setUserInfo=_ref.setUserInfo;var location=useLocation();useEffect(function(){var jwtToken=document.cookie.split('=')[1];var option={method:'POST',body:JSON.stringify({jwtToken:jwtToken}),headers:{'Content-type':'application/json; charset=UTF-8'}};fetch('https://music-pwa-api.iran.liara.run/api/users/auth',option).then(function(res){return res.json();}).then(function(data){if(jwtToken){if(data!==null&&data!==void 0&&data.isLogin){var _data$user,_data$user2;setUserInfo(data===null||data===void 0?void 0:data.user);if((data===null||data===void 0?void 0:(_data$user=data.user)===null||_data$user===void 0?void 0:_data$user.role)=='admin'){setProfileRoute('/adminprofile');}else if((data===null||data===void 0?void 0:(_data$user2=data.user)===null||_data$user2===void 0?void 0:_data$user2.role)=='user'){setProfileRoute('/userprofile');}}else{setProfileRoute(\"/login-signup\");}}});},[location]);var defaultProfileImageUrl=\"https://music-pwa-api.iran.liara.run/img/default.png\";return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"header\",{className:\"header\",id:\"header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"nav-container-top\",children:[/*#__PURE__*/_jsx(Link,{to:profileRoute,className:\"nav__logo\",children:userInfo===null||userInfo===void 0?void 0:userInfo.username}),/*#__PURE__*/_jsx(\"img\",{src:userInfo!==null&&userInfo!==void 0&&userInfo.profileImage?userInfo===null||userInfo===void 0?void 0:userInfo.profileImage:defaultProfileImageUrl,alt:\"\",className:\"nav__img\"})]}),/*#__PURE__*/_jsx(\"nav\",{className:\"nav-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"nav__menu\",id:\"nav-menu\",children:/*#__PURE__*/_jsxs(\"ul\",{className:\"nav__list\",children:[/*#__PURE__*/_jsx(Link,{to:\"/\",children:/*#__PURE__*/_jsx(\"li\",{className:\"nav__item\",id:\"home-btn\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"nav__link\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bx bx-home-alt nav__icon\"}),/*#__PURE__*/_jsx(\"span\",{className:\"nav__name\",children:\"\\u062E\\u0627\\u0646\\u0647\"})]})})}),/*#__PURE__*/_jsx(Link,{to:\"/search\",children:/*#__PURE__*/_jsx(\"li\",{className:\"nav__item\",id:\"search-btn\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"nav__link\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bx bx-search-alt nav__icon\"}),/*#__PURE__*/_jsx(\"span\",{className:\"nav__name\",children:\"\\u062C\\u0633\\u062A\\u062C\\u0648\"})]})})}),/*#__PURE__*/_jsx(Link,{to:\"/playlist\",children:/*#__PURE__*/_jsx(\"li\",{className:\"nav__item\",id:\"playlist-btn\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"nav__link\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bx bx-book-alt nav__icon\"}),/*#__PURE__*/_jsx(\"span\",{className:\"nav__name\",children:\"\\u067E\\u0644\\u06CC \\u0644\\u06CC\\u0633\\u062A\"})]})})}),/*#__PURE__*/_jsx(Link,{to:profileRoute,children:/*#__PURE__*/_jsx(\"li\",{className:\"nav__item\",id:\"profile-btn\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"nav__link\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bx bx-user nav__icon\"}),/*#__PURE__*/_jsx(\"span\",{className:\"nav__name\",children:\"\\u062D\\u0633\\u0627\\u0628 \\u06A9\\u0627\\u0631\\u0628\\u0631\\u06CC\"})]})})})]})})})]}),/*#__PURE__*/_jsx(Outlet,{})]});};export default Layout;","map":{"version":3,"names":["React","useState","useEffect","Outlet","Link","useLocation","redirect","Layout","profileRoute","setProfileRoute","userInfo","setUserInfo","location","jwtToken","document","cookie","split","option","method","body","JSON","stringify","headers","fetch","then","res","json","data","isLogin","user","role","defaultProfileImageUrl","username","profileImage"],"sources":["D:/github/music-pwa-frontend/src/pages/Layout.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport { Outlet, Link, useLocation, redirect } from \"react-router-dom\";\r\n\r\n\r\nconst Layout = ({ profileRoute, setProfileRoute, userInfo, setUserInfo }) => {\r\n\r\n\r\n    const location = useLocation();\r\n\r\n    useEffect(() => {\r\n\r\n        const jwtToken = document.cookie.split('=')[1];\r\n        const option = {\r\n            method: 'POST',\r\n            body: JSON.stringify({\r\n                jwtToken\r\n            }),\r\n            headers: {\r\n                'Content-type': 'application/json; charset=UTF-8',\r\n            }\r\n        };\r\n\r\n        fetch('https://music-pwa-api.iran.liara.run/api/users/auth', option)\r\n            .then((res) => res.json())\r\n            .then((data) => {\r\n                if (jwtToken) {\r\n                    if (data?.isLogin) {\r\n                        setUserInfo(data?.user)\r\n                        if (data?.user?.role == 'admin') {\r\n                            setProfileRoute('/adminprofile')\r\n                        } else if (data?.user?.role == 'user') {\r\n                            setProfileRoute('/userprofile')\r\n                        }\r\n                    } else {\r\n                        setProfileRoute(\"/login-signup\")\r\n                    }\r\n                }\r\n            })\r\n\r\n    }, [location])\r\n\r\n    const defaultProfileImageUrl = \"https://music-pwa-api.iran.liara.run/img/default.png\";\r\n\r\n    return (\r\n        <div>\r\n            <header className='header' id='header'>\r\n                <div className='nav-container-top'>\r\n                    <Link to={profileRoute} className=\"nav__logo\">{userInfo?.username}</Link>\r\n                    <img src={userInfo?.profileImage ? userInfo?.profileImage : defaultProfileImageUrl} alt=\"\" className=\"nav__img\" />\r\n                </div>\r\n                <nav className='nav-container'>\r\n                    <div className='nav__menu' id=\"nav-menu\">\r\n                        <ul className=\"nav__list\">\r\n                            <Link to=\"/\">\r\n                                <li className=\"nav__item\" id=\"home-btn\" >\r\n                                    <div className=\"nav__link\">\r\n                                        <i className='bx bx-home-alt nav__icon'></i>\r\n                                        <span className=\"nav__name\">خانه</span>\r\n                                    </div>\r\n                                </li>\r\n                            </Link>\r\n                            <Link to=\"/search\">\r\n                                <li className=\"nav__item\" id=\"search-btn\">\r\n                                    <div className=\"nav__link\">\r\n                                        <i className='bx bx-search-alt nav__icon'></i>\r\n                                        <span className=\"nav__name\">جستجو</span>\r\n                                    </div>\r\n                                </li>\r\n                            </Link>\r\n                            <Link to=\"/playlist\">\r\n                                <li className=\"nav__item\" id=\"playlist-btn\">\r\n                                    <div className=\"nav__link\">\r\n                                        <i className='bx bx-book-alt nav__icon'></i>\r\n                                        <span className=\"nav__name\">پلی لیست</span>\r\n                                    </div>\r\n                                </li>\r\n                            </Link>\r\n                            <Link to={profileRoute} >\r\n                                <li className=\"nav__item\" id=\"profile-btn\">\r\n                                    <div className=\"nav__link\">\r\n                                        <i className='bx bx-user nav__icon'></i>\r\n                                        <span className=\"nav__name\">حساب کاربری</span>\r\n                                    </div>\r\n                                </li>\r\n                            </Link>\r\n                        </ul>\r\n                    </div>\r\n                </nav>\r\n            </header>\r\n            <Outlet />\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Layout"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}