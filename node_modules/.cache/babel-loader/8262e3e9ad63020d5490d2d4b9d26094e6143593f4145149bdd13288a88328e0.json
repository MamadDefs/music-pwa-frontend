{"ast":null,"code":"import _slicedToArray from\"/home/saoshyant/Documents/GitHub/music-pwa-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{useNavigate}from'react-router';import Backdrop from'@mui/material/Backdrop';import CircularProgress from'@mui/material/CircularProgress';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LoginPage=function LoginPage(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showBox=_useState2[0],setShowBox=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),errorMessage=_useState4[0],setErrorMessage=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),signupUsername=_useState8[0],setSignupUsername=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),signupEmail=_useState10[0],setSignupEmail=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),signupPassword=_useState12[0],setSignupPassword=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),signupRePassword=_useState14[0],setSignupRePassword=_useState14[1];var _useState15=useState(''),_useState16=_slicedToArray(_useState15,2),signinUsername=_useState16[0],setSigninUsername=_useState16[1];var _useState17=useState(''),_useState18=_slicedToArray(_useState17,2),signinPassword=_useState18[0],setSigninPassword=_useState18[1];var navigate=useNavigate();var onSignup=function onSignup(e){setLoading(true);e.preventDefault();var option={method:'POST',body:JSON.stringify({username:signupUsername,email:signupEmail,password:signupPassword,passwordConfirm:signupRePassword}),headers:{'Content-type':'application/json; charset=UTF-8'}};fetch('https://music-pwa-api.iran.liara.run/api/users/sign-up',option).then(function(res){return res.json();}).then(function(data){setLoading(false);console.log(data);});};var onSignin=function onSignin(e){setLoading(true);e.preventDefault();var option={method:'POST',body:JSON.stringify({username:signinUsername,password:signinPassword}),headers:{'Content-type':'application/json; charset=UTF-8'}};fetch('https://music-pwa-api.iran.liara.run/api/users/sign-in',option).then(function(res){return res.json();}).then(function(data){setLoading(false);if(data!==null&&data!==void 0&&data.error){setErrorMessage(data===null||data===void 0?void 0:data.message);setShowBox(true);}if(data.token){var d=new Date();d.setTime(d.getTime()+90*24*60*60*1000);var expires=\"expires=\"+d.toUTCString();document.cookie=\"jwtToken=\".concat(data.token,\";\").concat(expires,\";path=/\");if(data.userRole==='admin'){navigate('/adminprofile');}else if(data.userRole==='user'){navigate('/userprofile');}}});};return/*#__PURE__*/_jsxs(\"div\",{className:\"form-holder\",children:[/*#__PURE__*/_jsx(Backdrop,{sx:{color:'#fff',zIndex:function zIndex(theme){return theme.zIndex.drawer+1;}},open:loading,children:/*#__PURE__*/_jsx(CircularProgress,{color:\"inherit\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"main\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"error-box\",children:showBox?errorMessage:''}),/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",id:\"chk\",\"aria-hidden\":\"true\"}),/*#__PURE__*/_jsx(\"div\",{className:\"signup\",children:/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"chk\",className:\"form-label\",\"aria-hidden\":\"true\",children:\"\\u0639\\u0636\\u0648\\u06CC\\u062A\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-input\",onChange:function onChange(e){setSignupUsername(e.target.value);},placeholder:\"\\u0646\\u0627\\u0645 \\u06A9\\u0627\\u0631\\u0628\\u0631\\u06CC\",required:\"\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",className:\"form-input\",onChange:function onChange(e){setSignupEmail(e.target.value);},placeholder:\"\\u0627\\u06CC\\u0645\\u06CC\\u0644\",required:\"\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-input\",onChange:function onChange(e){setSignupPassword(e.target.value);},placeholder:\"\\u067E\\u0633\\u0648\\u0631\\u062F\",required:\"\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-input\",onChange:function onChange(e){setSignupRePassword(e.target.value);},placeholder:\"\\u062A\\u06A9\\u0631\\u0627\\u0631 \\u067E\\u0633\\u0648\\u0631\\u062F\",required:\"\"}),/*#__PURE__*/_jsx(\"button\",{className:\"form-button\",onClick:function onClick(e){return onSignup(e);},children:\"\\u0639\\u0636\\u0648\\u06CC\\u062A\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"login\",children:/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"chk\",className:\"form-label\",\"aria-hidden\":\"true\",children:\"\\u0648\\u0631\\u0648\\u062F\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-input\",onChange:function onChange(e){setSigninUsername(e.target.value);},placeholder:\"\\u0646\\u0627\\u0645 \\u06A9\\u0627\\u0631\\u0628\\u0631\\u06CC\",required:\"\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-input\",onChange:function onChange(e){setSigninPassword(e.target.value);},placeholder:\"\\u067E\\u0633\\u0648\\u0631\\u062F\",required:\"\"}),/*#__PURE__*/_jsx(\"button\",{className:\"form-button\",onClick:function onClick(e){return onSignin(e);},children:\"\\u0648\\u0631\\u0648\\u062F\"})]})})]})]});};export default LoginPage;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","Backdrop","CircularProgress","LoginPage","showBox","setShowBox","errorMessage","setErrorMessage","loading","setLoading","signupUsername","setSignupUsername","signupEmail","setSignupEmail","signupPassword","setSignupPassword","signupRePassword","setSignupRePassword","signinUsername","setSigninUsername","signinPassword","setSigninPassword","navigate","onSignup","e","preventDefault","option","method","body","JSON","stringify","username","email","password","passwordConfirm","headers","fetch","then","res","json","data","console","log","onSignin","error","message","token","d","Date","setTime","getTime","expires","toUTCString","document","cookie","userRole","color","zIndex","theme","drawer","target","value"],"sources":["/home/saoshyant/Documents/GitHub/music-pwa-frontend/src/pages/LoginPage.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { useNavigate } from 'react-router';\nimport Backdrop from '@mui/material/Backdrop';\nimport CircularProgress from '@mui/material/CircularProgress';\n\nconst LoginPage = () => {\n\n  const [showBox, setShowBox] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [loading, setLoading] = useState(false)\n\n  const [signupUsername, setSignupUsername] = useState('');\n  const [signupEmail, setSignupEmail] = useState('');\n  const [signupPassword, setSignupPassword] = useState('');\n  const [signupRePassword, setSignupRePassword] = useState('');\n\n  const [signinUsername, setSigninUsername] = useState('');\n  const [signinPassword, setSigninPassword] = useState('');\n\n  const navigate = useNavigate();\n\n  const onSignup = (e) => {\n    setLoading(true);\n    e.preventDefault();\n    const option = {\n      method: 'POST',\n      body: JSON.stringify({\n        username: signupUsername,\n        email: signupEmail,\n        password: signupPassword,\n        passwordConfirm: signupRePassword\n      }),\n      headers: {\n        'Content-type': 'application/json; charset=UTF-8',\n      }\n    };\n\n    fetch('https://music-pwa-api.iran.liara.run/api/users/sign-up', option)\n      .then((res) => res.json())\n      .then((data) => {\n        setLoading(false);\n        console.log(data);\n      })\n  }\n\n  const onSignin = (e) => {\n    setLoading(true);\n    e.preventDefault();\n    const option = {\n      method: 'POST',\n      body: JSON.stringify({\n        username: signinUsername,\n        password: signinPassword\n      }),\n      headers: {\n        'Content-type': 'application/json; charset=UTF-8',\n      }\n    };\n\n    fetch('https://music-pwa-api.iran.liara.run/api/users/sign-in', option)\n      .then((res) => res.json())\n      .then((data) => {\n        setLoading(false)\n        if (data?.error) {\n          setErrorMessage(data?.message);\n          setShowBox(true);\n        }\n        if (data.token) {\n          const d = new Date();\n          d.setTime(d.getTime() + (90 * 24 * 60 * 60 * 1000));\n          let expires = \"expires=\" + d.toUTCString();\n          document.cookie = `jwtToken=${data.token};${expires};path=/`;\n          if (data.userRole === 'admin') {\n            navigate('/adminprofile')\n          } else if (data.userRole === 'user') {\n            navigate('/userprofile')\n          }\n        }\n      })\n\n  }\n\n  return (\n    <div className='form-holder'>\n      <Backdrop\n        sx={{ color: '#fff', zIndex: (theme) => theme.zIndex.drawer + 1 }}\n        open={loading}\n      >\n        <CircularProgress color=\"inherit\" />\n      </Backdrop>\n      <div className=\"main\">\n        <div className='error-box'>{showBox ? errorMessage : ''}</div>\n        <input type=\"checkbox\" id=\"chk\" aria-hidden=\"true\" />\n        <div className=\"signup\">\n          <form>\n            <label htmlFor=\"chk\" className='form-label' aria-hidden=\"true\">عضویت</label>\n            <input type=\"text\" className='form-input' onChange={(e) => { setSignupUsername(e.target.value) }} placeholder=\"نام کاربری\" required=\"\" />\n            <input type=\"email\" className='form-input' onChange={(e) => { setSignupEmail(e.target.value) }} placeholder=\"ایمیل\" required=\"\" />\n            <input type=\"password\" className='form-input' onChange={(e) => { setSignupPassword(e.target.value) }} placeholder=\"پسورد\" required=\"\" />\n            <input type=\"password\" className='form-input' onChange={(e) => { setSignupRePassword(e.target.value) }} placeholder=\"تکرار پسورد\" required=\"\" />\n            <button className='form-button' onClick={(e) => onSignup(e)}>عضویت</button>\n          </form>\n        </div>\n\n        <div className=\"login\">\n          <form>\n            <label htmlFor=\"chk\" className='form-label' aria-hidden=\"true\">ورود</label>\n            <input type=\"text\" className='form-input' onChange={(e) => { setSigninUsername(e.target.value) }} placeholder=\"نام کاربری\" required=\"\" />\n            <input type=\"password\" className='form-input' onChange={(e) => { setSigninPassword(e.target.value) }} placeholder=\"پسورد\" required=\"\" />\n            <button className='form-button' onClick={(e) => onSignin(e)}>ورود</button>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default LoginPage"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}